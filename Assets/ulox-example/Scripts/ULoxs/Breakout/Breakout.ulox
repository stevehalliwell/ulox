var bricks = List();
var walls = List();
var ball;
var paddle;
var points = 0;
var lives = 3;

fun SetupGame()
{
    CreateLevel();
}

fun CreateLevel()
{
    walls.Add(Wall(Vec2.Create(-40,0), Vec2.Create(10,80)));
    walls.Add(Wall(Vec2.Create(40,0), Vec2.Create(10,80)));
    walls.Add(Wall(Vec2.Create(0,-40), Vec2.Create(80,10)));
    walls.Add(Wall(Vec2.Create(0,40), Vec2.Create(80,10)));

    var generator = GridGenerator(Vec2.Create(0,30), Vec2.Create(6,3));
    var posList = generator.FromRowCol(3,10);
    CreateBricksFromPositions(posList);
    ball = Ball(Vec2.Create(0,-20));
    SetRigidBody2DVelocity(ball.rb, 15,15);
    paddle = Paddle(Vec2.Create(0,-30), 30);
}

fun CreateBricksFromPositions(posList)
{
    for(var i = 0; i < posList.Count(); i+=1)
    {
        var newBrick = Brick(posList.Get(i), i % 2);
        bricks.Add(newBrick);
    }
}

var dt;
fun Update()
{
    UpdateGame(dt);
    SetUIText(
        "Points: " + str(points) + "\n" +
        "Lives: " + str(lives)
        );
}

fun UpdateGame(dt)
{
	if(GetKey("escape")){ReloadScene();}

	paddle.Update(dt);
}

fun GivePointsForBrick(brickStrength)
{
    points += (brickStrength+1) * 10;
}